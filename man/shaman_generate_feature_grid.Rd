% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/shaman_feature_grid.R
\name{shaman_generate_feature_grid}
\alias{shaman_generate_feature_grid}
\title{Calculate spatial enrichment of contacts between two features}
\usage{
shaman_generate_feature_grid(feature1, feature2, obs_track_nm,
  exp_track_nm = paste0(obs_track_nm, "_shuffle"),
  score_track_nm = paste0(obs_track_nm, "_score"), score_filter = 30,
  range = 25000, resolution = 500, min_dist = 2e+05, max_dist = 1e+06)
}
\arguments{
\item{feature1}{1d intervals representing feature 1. Strand, if provided will be ignored.}

\item{feature2}{1d intervals representing feature 2. Strand, if provided will be ignored.}

\item{obs_track_nm}{Name of observed 2D genomic track for the hic data.}

\item{exp_track_nm}{Name of expected 2D genomic track.}

\item{score_track_nm}{Name of 2D score track. If track doesn't exist, no filter on grid will be applied.}

\item{score_filter}{Minimum value of score within the expanded window surrounding the grid point for the window
to be considered in the statistics.}

\item{range}{Window size around the grid point.}

\item{resolution}{Size of bins (in base pairs).}

\item{min_dist}{Minimum distance between features on the grid.}

\item{max_dist}{Maximum distance between features on the grid.}
}
\value{
list containing obs - observed matrix, sum of the number of observed contacts in each bin in the window,
exp - expected matrix, sum of the number of expected contacts in each bin in the window,
grid_size - number of windows included in statistics
}
\description{
\code{shaman_generate_feature_grid}
}
\details{
Build a grid comprising of all combinations of intervals from feature 1 and feature 2 that
fall within a band defined by min_dist and max_dist. For each point on the grid,
look at th surrounding window, defined by range parameter. Discard all windows
that do not contain a point with a score (defined in scotre_track_nm) above the score_filter parameter.
This allows for focusing on potentially enriched pairs.
Discect the window into small bins, size in base pairs defined by the resolution parameter, and count
the number of observed contacts, and the number of expected contacts in each bin.
All windows are then summed together, generating a single matrix of observed and expected contacts, which is
returned by function.
Note that grid contains only points in which feature 1 position is smaller than feature 2 position.
}

