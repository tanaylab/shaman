<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate spatial enrichment of contacts between two features — shaman_generate_feature_grid • shaman</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate spatial enrichment of contacts between two features — shaman_generate_feature_grid"><meta property="og:description" content="shaman_generate_feature_grid"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shaman</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/shaman-package.html">
    <span class="fa fa-road"></span>
     
    Usage
  </a>
</li>
<li>
  <a href="../articles/import.html">
    <span class="fa fa-filter"></span>
     
    Import
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.org/tanaylab/shaman" class="external-link">
    <span class="fa fa-github-square"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate spatial enrichment of contacts between two features</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/shaman/blob/HEAD/R/shaman_feature_grid.R" class="external-link"><code>R/shaman_feature_grid.R</code></a></small>
    <div class="hidden name"><code>shaman_generate_feature_grid.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>shaman_generate_feature_grid</code></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">shaman_generate_feature_grid</span><span class="op">(</span>
  <span class="va">feature1</span>,
  <span class="va">feature2</span>,
  <span class="va">obs_track_nm</span>,
  exp_track_nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">obs_track_nm</span>, <span class="st">"_shuffle"</span><span class="op">)</span>,
  score_track_nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">obs_track_nm</span>, <span class="st">"_score"</span><span class="op">)</span>,
  score_filter <span class="op">=</span> <span class="fl">30</span>,
  range <span class="op">=</span> <span class="fl">25000</span>,
  resolution <span class="op">=</span> <span class="fl">500</span>,
  min_dist <span class="op">=</span> <span class="fl">200000</span>,
  max_dist <span class="op">=</span> <span class="fl">1000000</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>feature1</dt>
<dd><p>1d intervals representing feature 1. Strand, if provided will be ignored.</p></dd>
<dt>feature2</dt>
<dd><p>1d intervals representing feature 2. Strand, if provided will be ignored.</p></dd>
<dt>obs_track_nm</dt>
<dd><p>Name of observed 2D genomic track for the hic data.</p></dd>
<dt>exp_track_nm</dt>
<dd><p>Name of expected 2D genomic track.</p></dd>
<dt>score_track_nm</dt>
<dd><p>Name of 2D score track. If track doesn't exist, no filter on grid will be applied.</p></dd>
<dt>score_filter</dt>
<dd><p>Minimum value of score within the expanded window surrounding the grid point for the window
to be considered in the statistics.</p></dd>
<dt>range</dt>
<dd><p>Window size around the grid point.</p></dd>
<dt>resolution</dt>
<dd><p>Size of bins (in base pairs).</p></dd>
<dt>min_dist</dt>
<dd><p>Minimum distance between features on the grid.</p></dd>
<dt>max_dist</dt>
<dd><p>Maximum distance between features on the grid.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>list containing obs - observed matrix, sum of the number of observed contacts in each bin in the window,
exp - expected matrix, sum of the number of expected contacts in each bin in the window,
grid_size - number of windows included in statistics</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Build a grid comprising of all combinations of intervals from feature 1 and feature 2 that
fall within a band defined by min_dist and max_dist. For each point on the grid,
look at th surrounding window, defined by range parameter. Discard all windows
that do not contain a point with a score (defined in scotre_track_nm) above the score_filter parameter.
This allows for focusing on potentially enriched pairs.
Discect the window into small bins, size in base pairs defined by the resolution parameter, and count
the number of observed contacts, and the number of expected contacts in each bin.
All windows are then summed together, generating a single matrix of observed and expected contacts, which is
returned by function.
Note that grid contains only points in which feature 1 position is smaller than feature 2 position.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># Set misha db to test</span></span>
<span class="r-in"><span class="fu">gsetroot</span><span class="op">(</span><span class="fu"><a href="shaman_get_test_track_db.html">shaman_get_test_track_db</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in setwd(groot):</span> cannot change working directory</span>
<span class="r-in"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu">shaman_generate_feature_grid</span><span class="op">(</span><span class="fu">shaman</span><span class="fu">::</span><span class="va"><a href="ctcf_forward.html">ctcf_forward</a></span>, <span class="fu">shaman</span><span class="fu">::</span><span class="va"><a href="ctcf_reverse.html">ctcf_reverse</a></span>, <span class="st">"hic_obs"</span>,</span>
<span class="r-in">    exp_track_nm <span class="op">=</span> <span class="st">"hic_exp"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in shaman_generate_feature_grid(shaman::ctcf_forward, shaman::ctcf_reverse,     "hic_obs", exp_track_nm = "hic_exp"):</span> Missing obs_track_nm ( hic_obs ) in track db</span>
<span class="r-in"><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="shaman_plot_feature_grid.html">shaman_plot_feature_grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>, <span class="fl">25000</span>, <span class="fl">500</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object of type 'closure' is not subsettable</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Amos Tanay, Netta Mendelson Cohen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

